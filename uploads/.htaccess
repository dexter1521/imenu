# Protección para carpeta uploads
# Solo permite acceso a imágenes y archivos específicos

# Bloquear ejecución de PHP
<Files "*.php">
    <IfModule authz_core_module>
        Require all denied
    </IfModule>
    <IfModule !authz_core_module>
        Order allow,deny
        Deny from all
    </IfModule>
</Files>

# Solo permitir tipos de archivo específicos
<FilesMatch "\.(jpg|jpeg|png|gif|svg|pdf|zip)$">
    <IfModule authz_core_module>
        Require all granted
    </IfModule>
    <IfModule !authz_core_module>
        Order deny,allow
        Allow from all
    </IfModule>
</FilesMatch>

# Bloquear todo lo demás
<FilesMatch "^(?!\.(jpg|jpeg|png|gif|svg|pdf|zip)$).*$">
    <IfModule authz_core_module>
        Require all denied
    </IfModule>
    <IfModule !authz_core_module>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# Headers de seguridad para archivos subidos
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set Content-Disposition "attachment"
</IfModule>
